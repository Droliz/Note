## 什么是微前端

微前端是一种多个团队通过独立发布功能的方式来共同构建现代化 web 应用的技术手段及方法策略。

微前端借鉴了微服务的架构理念，**将一个庞大的前端应用拆分为多个独立灵活的小型应用**，每个应用都可以独立开发、独立运行、独立部署，再将这些小型应用联合为一个完整的应用。微前端既可以将多个项目融合为一，又可以减少项目之间的耦合，提升项目扩展性，相比一整块的前端仓库，微前端架构下的前端仓库倾向于更小更灵活

## 特性

-   **技术栈无关** 主框架不限制接入应用的技术栈，子应用可自主选择技术栈
-   **独立开发/部署** 各个团队之间仓库独立，单独部署，互不依赖
-   **增量升级** 当一个应用庞大之后，技术升级或重构相当麻烦，而微应用具备渐进式升级的特性
-   **独立运行时** 微应用之间运行时互不依赖，有独立的状态管理
-   **提升效率** 应用越庞大，越难以维护，协作效率越低下。微应用可以很好拆分，提升效率


## 主流微前端方案

### **基于** **`iframe`** **完全隔离的方案**

作为[前端开发](https://so.csdn.net/so/search?q=%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91&spm=1001.2101.3001.7020)，我们对 `iframe` 已经非常熟悉了，在一个应用中可以独立运行另一个应用。它具有显著的优点：

1.  非常简单，无需任何改造
2.  完美隔离，JS、CSS 都是独立的运行环境
3.  不限制使用，页面上可以放多个 `iframe` 来组合业务

当然，缺点也非常突出：

1.  无法保持路由状态，刷新后路由状态就丢失
2.  完全的隔离导致与子应用的交互变得极其困难，只能采用postMessage方式。
3.  `iframe` 中的弹窗无法突破其本身
4.  整个应用全量资源加载，加载太慢

这些显著的缺点也催生了其他方案的产生。

### **基于** **`single-spa`** **路由劫持方案**

`single-spa 是社区公认的主流方案，可以基于它做二次开发。`

通过劫持路由的方式来做子应用之间的切换，但接入方式需要融合自身的路由，有一定的局限性。

### **`阿里 qiankun`**

`qiankun` 对 `single-spa` 做了一层封装。主要解决了 `single-spa` 的一些痛点和不足。通过 `import-html-entry` 包解析 `HTML` 获取资源路径，然后对资源进行解析、加载。

qiankun 可以用于任意 js 框架，微应用接入像嵌入一个 [iframe](https://so.csdn.net/so/search?q=iframe&spm=1001.2101.3001.7020) 系统一样简单。qiankun@2.0 将跳出 route-based 的微前端场景。

**优点**

1.  阿里团队开发维护，文档多。
2.  基于single-spa 封装，提供了更加开箱即用的 API。
3.  HTML Entry 接入方式，让你接入微应用像使用 iframe 一样简单。
4.  样式隔离，确保微应用之间样式互相不干扰。
5.  JS 沙箱，确保微应用之间 全局变量/事件 不冲突。
6.  资源预加载，在浏览器空闲时间预加载未打开的微应用资源，加速微应用打开速度。
7.  umi 插件，提供了@umijs/plugin-qiankun 供 umi 应用一键切换成微前端架构系统。
8.  兼容IE11

**缺点**

1.  上线部署文档较少
2.  qiankun 只能解决子项目之间的样式相互污染，不能解决子项目的样式污染主项目的样式

### **京东** **`micro-app`** **方案**

京东 `micro-app` 并没有沿袭 `single-spa` 的思路，而是借鉴了 `WebComponent` 的思想，通过 `CustomElement` 结合自定义的 `ShadowDom`，将微前端封装成一个类 `webComponents` 组件，从而实现微前端的组件化渲染。

